<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>CRAVE CART ‚Äì Spin & Win</title>
  <style>
    * { box-sizing: border-box; font-family: 'Arial Black', sans-serif; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; padding: 10px; min-height: 100vh; background: linear-gradient(135deg, #ff416c, #ff4b2b); display: flex; justify-content: center; align-items: center; overflow-x: hidden; }
    .app { width: 100%; max-width: 400px; padding: 15px; text-align: center; background: white; border-radius: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.3); border: 6px solid #ffd700; }
    .promo-banner { background: #ffd700; color: #d32f2f; padding: 12px; border-radius: 15px; font-size: 16px; font-weight: 900; margin-bottom: 10px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .lock-box { background: #fff3e0; border: 2px dashed #ff9800; padding: 15px; border-radius: 20px; margin-bottom: 15px; color: #e65100; font-size: 14px; }
    
    /* SECRET TRIGGER: The Title */
    h1#secret-tap { margin: 5px 0 0 0; font-size: 28px; color: #333; cursor: pointer; user-select: none; }
    
    .tagline { margin-bottom: 10px; font-weight: bold; color: #ff4b2b; font-size: 12px; }
    .circle { margin: 15px auto; width: 100%; aspect-ratio: 1/1; display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    .item { background: #fff5f5; border: 2px solid #ffe0e0; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 24px; transition: 0.2s; }
    .active { background: #00c853 !important; transform: scale(1.1); box-shadow: 0 0 15px #00c853; border-color: white; z-index: 5; }
    .spin-btn { background: #ff4b2b; color: white; width: 100%; padding: 20px; border-radius: 20px; font-size: 20px; font-weight: 900; border: none; box-shadow: 0 5px 0 #b71c1c; }
    .spin-btn:disabled { background: #ccc; box-shadow: none; }
    .result { margin-top: 15px; font-size: 18px; font-weight: 900; min-height: 25px; line-height: 1.4; }
    .admin-reset { margin-top: 20px; font-size: 11px; color: #999; text-decoration: underline; display: block; cursor: pointer; }
  </style>
</head>
<body>
  <div class="app">
    <div class="promo-banner">üéÅ SPIN & WIN FREE FOOD! ü•§</div>
    
    <h1 id="secret-tap">CRAVE CART</h1>
    <div class="tagline">TASTE ‚Ä¢ CRAVE ‚Ä¢ REPEAT</div>

    <div id="setup" class="lock-box">
        <b>LOCKED üîí</b><br>
        Ask staff to unlock after your purchase!
    </div>

    <div class="circle" id="circle">
      <div class="item" data-name="Patishapta">ü•û</div>
      <div class="item" data-name="Makhana">üå∂Ô∏è</div>
      <div class="item" data-name="Maggie Bhel">üçú</div>
      <div class="item" data-name="Coffee">‚òï</div>
      <div class="item" data-name="Choco Ball">üç´</div>
      <div class="item" data-name="Malai Bread">üçû</div>
      <div class="item" data-name="Chowmein">üçù</div>
      <div class="item" data-name="Toffee">üç¨</div>
      <div class="item" data-name="Try Again">‚ùå</div>
    </div>

    <button class="spin-btn" id="spin" disabled>START SPINNING!</button>
    <div class="result" id="result"></div>
    <a class="admin-reset" onclick="location.reload()">Next Customer</a>
  </div>

<script>
  let clickCount = 0;
  let clickTimer;
  let spinsAvailable = 0;

  const items = document.querySelectorAll('.item');
  const spinBtn = document.getElementById('spin');
  const result = document.getElementById('result');
  const setupArea = document.getElementById('setup');
  const tapTrigger = document.getElementById('secret-tap');

  // SECRET UNLOCK: Tap "CRAVE CART" 3 times
  tapTrigger.onclick = () => {
    if (spinsAvailable > 0) return;
    clickCount++;
    clearTimeout(clickTimer);
    clickTimer = setTimeout(() => { clickCount = 0; }, 600); 

    if (clickCount === 3) {
      setupArea.innerHTML = "<b style='color:green'>UNLOCKED ‚úÖ</b><br>Good Luck!";
      setupArea.style.background = "#e8f5e9";
      setupArea.style.borderColor = "#4caf50";
      spinBtn.disabled = false;
      spinsAvailable = 1;
      clickCount = 0;
    }
  };

  spinBtn.onclick = () => {
    if (spinsAvailable <= 0) return;
    spinsAvailable--;
    spinBtn.disabled = true;
    result.style.color = "#333";
    result.textContent = "Spinning...";

    // ODDS: 88% Common / 7% Mid / 5% Rare
    let targetIndex;
    let roll = Math.random() * 100; 

    if (roll < 88) {
      const options = [3, 7, 8]; // Coffee, Toffee, Try Again
      targetIndex = options[Math.floor(Math.random() * options.length)];
    } else if (roll < 95) {
      targetIndex = 4; // Choco Ball (7%)
    } else {
      const options = [0, 5, 6]; // Patishapta, Malai Bread, Chowmein (5%)
      targetIndex = options[Math.floor(Math.random() * options.length)];
    }

    let currentIndex = 0;
    let totalSteps = 27 + targetIndex; 
    let currentSpeed = 60;

    function runSpin() {
      items.forEach(i => i.classList.remove('active'));
      items[currentIndex % items.length].classList.add('active');

      if (currentIndex < totalSteps) {
        currentIndex++;
        if (currentIndex > totalSteps - 8) currentSpeed += 70; 
        setTimeout(runSpin, currentSpeed);
      } else {
        const won = items[targetIndex].dataset.name;
        let winMessage = won === "Try Again" ? 
            "<span style='color:#555'>Don't give up! Try again next visit! ‚ú®</span>" : 
            "<span style='color:green'>WINNER: FREE " + won.toUpperCase() + "! üèÜ</span>";
        
        if (won !== "Try Again") {
          document.body.style.background = "#ffd700";
          setTimeout(() => { document.body.style.background = ""; }, 400);
        }
        result.innerHTML = winMessage + "<br><span style='color:#d32f2f; font-size: 14px; font-weight: bold;'>No spins left. Buy more to play!</span>";
      }
    }
    runSpin();
  };
</script>
</body>
</html>
